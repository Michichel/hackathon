<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Hisporés Login</title>
    <link rel="icon" href="../MEDIA/Logo.png" type="image/png" sizes="64x64">
    <link href="../CSS/styles.css" rel="stylesheet">
</head>

<body style="background-image: url(../MEDIA/background.jpg);">
    <div class="fondo">
        <div class="shapes"></div>
        <div class="shapes"></div>
    </div>

    <form id="loginForm">
        <h3>Inicio de Sesión</h3>
        <label for="email">Correo Electrónico
            <input type="email" placeholder="Email" id="email" required>
        </label>

        <label for="password">Contraseña
            <input type="password" placeholder="Contraseña" id="password" required>
        </label>
        <input type="submit" id="ingresar01" class="login" value="Ingresar" />

        <div class="form">
            <p>Aún no posees una cuenta? <a href="./register.view.html">Registrarse</a></p>
        </div>
    </form>

    <script type="module">
        // Importar las funciones necesarias de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js";
    
        const firebaseConfig = {
            apiKey: "AIzaSyCVwTeRtJja30in136sCvEoURNyb2u4w6M",
            authDomain: "hispores-12d75.firebaseapp.com",
            projectId: "hispores-12d75",
            storageBucket: "hispores-12d75.appspot.com",
            messagingSenderId: "965036664312",
            appId: "1:965036664312:web:52c9f996c49b3e1b4e620d",
            measurementId: "G-BEKX9W70KX"
        };
    
        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
    
        // Obtener referencia al formulario
        const loginForm = document.getElementById('loginForm');
    
        // Manejar el evento de envío del formulario
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault(); // Prevenir el comportamiento por defecto del formulario
    
            // Obtener los valores de los campos de entrada
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
    
            // Validar que los campos no estén vacíos
            if (!email || !password) {
                alert("Por favor, completa todos los campos.");
                return;
            }
    
            try {
                // Intentar autenticar al usuario con Firebase
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
    
                // Inicio de sesión exitoso
                const user = userCredential.user;
                alert('Inicio de sesión exitoso.');
    
                // Redirigir al usuario a la página principal
                window.location.href = 'first_page.html';
    
            } catch (error) {
                const errorCode = error.code;
                const errorMessage = error.message;
                
                // Personalizar mensajes de error según el código de error
                switch(errorCode) {
                    case 'auth/invalid-email':
                        alert('El correo electrónico no es válido.');
                        break;
                    case 'auth/user-disabled':
                        alert('Este usuario ha sido deshabilitado.');
                        break;
                    case 'auth/user-not-found':
                        alert('No se encontró un usuario con este correo electrónico.');
                        break;
                    case 'auth/wrong-password':
                        alert('La contraseña es incorrecta.');
                        break;
                    default:
                        alert('Error: ' + errorMessage);
                }
            }
        });
    </script>
    
</body>
<footer>
    <div class="container">
        <p>&copy; Hisporés hackaton</p>
    </div>
</footer>
</html>
